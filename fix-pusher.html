<!DOCTYPE html>
<html>
<head>
    <title>Fix Pusher Cluster Issue</title>
</head>
<body>
    <h1>Fixing Pusher Cluster Requirement</h1>
    <div id="output"></div>
    
    <script src="https://js.pusher.com/8.2.0/pusher.min.js"></script>
    <script>
        function log(msg) {
            document.getElementById('output').innerHTML += '<div>' + msg + '</div>';
            console.log(msg);
        }
        
        log('Testing Pusher configurations...');
        
        // Test 1: With empty cluster
        try {
            const pusher1 = new Pusher('test-key', {
                cluster: '',
                wsHost: '127.0.0.1',
                wsPort: 6001,
                forceTLS: false
            });
            log('‚úÖ SUCCESS: Empty cluster works');
        } catch (e) {
            log('‚ùå Empty cluster failed: ' + e);
        }
        
        // Test 2: With fake cluster
        try {
            const pusher2 = new Pusher('test-key', {
                cluster: 'mt1',
                wsHost: '127.0.0.1',
                wsPort: 6001,
                forceTLS: false
            });
            log('‚úÖ SUCCESS: Fake cluster mt1 works');
        } catch (e) {
            log('‚ùå Fake cluster failed: ' + e);
        }
        
        // Test 3: With minimal valid config
        try {
            const pusher3 = new Pusher('test-key', {
                cluster: 'mt1'
            });
            log('‚úÖ SUCCESS: Minimal config works');
        } catch (e) {
            log('‚ùå Minimal config failed: ' + e);
        }
        
        // Test 4: Override host completely
        try {
            const pusher4 = new Pusher('test-key', {
                cluster: 'mt1',
                wsHost: '127.0.0.1',
                wsPort: 6001,
                wssPort: 6001,
                forceTLS: false,
                encrypted: false,
                enabledTransports: ['ws']
            });
            log('‚úÖ SUCCESS: Full override works');
            
            // Try to connect
            pusher4.connection.bind('connected', () => {
                log('üéâ PUSHER CONNECTED SUCCESSFULLY!');
            });
            
            pusher4.connection.bind('error', (err) => {
                log('‚ùå Connection error: ' + JSON.stringify(err));
            });
            
        } catch (e) {
            log('‚ùå Full override failed: ' + e);
        }
    </script>
</body>
</html>
