<!DOCTYPE html>
<html>
<head>
    <title>Camera/Mic Test</title>
</head>
<body>
    <h1>Camera/Microphone Test</h1>
    <button onclick="testDevices()">Test Camera & Microphone</button>
    <div id="results"></div>
    <video id="localVideo" autoplay muted style="width: 300px; height: 200px; border: 1px solid #ccc;"></video>
    
    <script>
        async function testDevices() {
            const results = document.getElementById('results');
            const video = document.getElementById('localVideo');
            
            results.innerHTML = '<h2>Testing devices...</h2>';
            let html = '';
            
            try {
                // Test camera
                console.log('Testing camera...');
                const videoStream = await navigator.mediaDevices.getUserMedia({ video: true });
                html += '<p>‚úÖ Camera access: SUCCESS</p>';
                video.srcObject = videoStream;
                
                // Test microphone
                console.log('Testing microphone...');
                const audioStream = await navigator.mediaDevices.getUserMedia({ audio: true });
                html += '<p>‚úÖ Microphone access: SUCCESS</p>';
                
                // Combine both
                const combinedStream = await navigator.mediaDevices.getUserMedia({ 
                    video: true, 
                    audio: true 
                });
                html += '<p>‚úÖ Combined camera + microphone: SUCCESS</p>';
                html += '<p><strong>‚úÖ All devices working - meeting should work now!</strong></p>';
                
                video.srcObject = combinedStream;
                
            } catch (error) {
                html += `<p>‚ùå Device access failed: ${error.name}</p>`;
                html += `<p>Error: ${error.message}</p>`;
                
                if (error.name === 'NotAllowedError') {
                    html += '<h3>üîß Fix: Browser Permission Denied</h3>';
                    html += '<p>1. Click camera/microphone icon in address bar</p>';
                    html += '<p>2. Choose "Always allow" for this site</p>';
                    html += '<p>3. Refresh page and try again</p>';
                } else if (error.name === 'NotFoundError') {
                    html += '<h3>üîß Fix: No Camera/Microphone Found</h3>';
                    html += '<p>1. Connect camera/microphone</p>';
                    html += '<p>2. Check device is not used by other apps</p>';
                } else if (error.name === 'NotReadableError') {
                    html += '<h3>üîß Fix: Device Busy</h3>';
                    html += '<p>1. Close other apps using camera/microphone</p>';
                    html += '<p>2. Restart browser</p>';
                }
            }
            
            results.innerHTML = html;
        }
    </script>
</body>
</html>
