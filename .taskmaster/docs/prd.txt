# Itqan Platform - Feature Completion PRD

## Project Overview
Complete all pending features of the Itqan Educational Platform across 4 major phases. The platform serves multiple educational sections: Quran learning, Academic tutoring, Interactive courses, and Recorded courses.

## Critical Success Factors
- Zero Breaking Changes - All existing features must continue working
- Unified Architecture - Common patterns across all educational sections
- Scalable Design - Support multi-tenancy and future growth
- Performance First - Optimized queries and real-time capabilities

## Phase 1: Foundation & Critical Features (Priority 10)

### 1.1 Unified Meeting System with LiveKit
Implement a single unified Meeting model with polymorphic relationships to replace scattered meeting configurations. Integrate LiveKit SDK for video conferencing with server-side token generation and real-time participant tracking.

**Deliverables:**
- Meeting model with polymorphic relationships (meetable_type, meetable_id)
- MeetingService for room management and token generation
- LiveKit integration (room creation, participant tracking, recording)
- Unified meeting UI component using LiveKit client SDK
- Migration of existing meeting configs to new structure

### 1.2 Unified Attendance System
Create UnifiedAttendanceService with common attendance calculation logic across all session types. Implement auto-attendance tracking from LiveKit participant events and manual override functionality for teachers.

**Deliverables:**
- UnifiedAttendanceService with attendance calculation algorithms
- academic_session_attendances table (mirror quran structure)
- interactive_session_attendances table
- Auto-attendance from LiveKit participant join/leave events
- Manual override UI for teachers with reason tracking
- Configurable thresholds (late_tolerance, attendance_threshold)
- Real-time attendance sync using WebSockets

### 1.3 Configuration Enums & Settings
Standardize all session durations and academy-level settings. Replace hardcoded values with configurable enums and database-backed settings.

**Deliverables:**
- SessionDuration enum (30, 60, 90 minutes)
- AcademySettings model and table
- Academy-level default configurations
- Filament resource for settings management
- Update all existing models to use enum

## Phase 2: Core Educational Features (Priority 10)

### 2.1 Complete Interactive Courses Feature
Add missing homework, payment flow, and teacher compensation to interactive courses. Enable one-time enrollment payment and flexible teacher payment models.

**Deliverables:**
- InteractiveCourseHomework model
- One-time enrollment payment flow for students
- Teacher payment calculation (fixed, per_student, per_session)
- Student enrollment UI (browse → enroll → pay)
- Session scheduling for interactive courses
- Integration with unified Meeting and Attendance systems

### 2.2 Individual Academic Session Booking Flow
Build complete student-to-teacher booking workflow for one-on-one academic sessions. Enable public browsing, package selection, payment, and teacher scheduling.

**Deliverables:**
- Public academic teacher browsing page with filters
- Package selection and subscription checkout UI
- Teacher notification system (email + in-app)
- Teacher session scheduling interface in Filament
- Drag-drop calendar for session scheduling
- Student subscription management page
- Payment processing for academic subscriptions

### 2.3 Homework Submission & Grading System
Create unified homework system across all educational sections with file uploads, text answers, and teacher grading workflow.

**Deliverables:**
- Unified homework submission UI for students
- File upload component (images, PDFs)
- Text answer support with rich text editor
- Teacher grading interface with feedback
- Grading workflow (pending → graded → returned)
- Homework notifications (assigned, graded)
- My Homework page for students
- Teacher homework statistics dashboard

## Phase 3: Extended Features (Priority 5-9)

### 3.1 Parent Dashboard Suite
Create comprehensive dashboard for parents to monitor multiple children's progress, sessions, payments, and communicate with teachers.

**Deliverables:**
- Parent dashboard home page
- Children management interface with switcher
- Session viewing per child (upcoming, past)
- Progress monitoring dashboard
- Payment management interface
- Messaging with teachers (Chatify integration)
- Report viewing interface
- Notification preferences

### 3.2 Teacher Availability Calendar
Enable teachers to manage their weekly availability, exception dates, and integrate with student booking flow.

**Deliverables:**
- Teacher availability management interface
- Weekly availability grid (Filament widget)
- Exception/vacation dates management
- Student booking integration
- Conflict detection algorithm
- Calendar visualization for teachers
- Bulk scheduling for recurring sessions

### 3.3 Comprehensive Student Reports
Implement polymorphic unified reporting system with section-specific performance data and multiple report types.

**Deliverables:**
- SessionReport polymorphic model
- Section-specific report cards (Quran, Academic, Interactive)
- Monthly aggregation reports
- Overall performance dashboard
- Teacher report generation interface
- Student and parent report viewing pages
- Report filtering (date, section, performance)
- Report sharing (teacher → parent)

## Phase 4: Advanced Features (Priority 3-5)

### 4.1 Quiz & Assessment System
Build comprehensive quiz system with question bank, auto-grading, and analytics.

**Deliverables:**
- Quiz polymorphic model
- Question bank (MCQ, True/False, Essay)
- Quiz creation interface for teachers (Filament)
- Student quiz-taking interface
- Auto-grading for objective questions
- Manual grading for essays
- Quiz results dashboard and analytics

### 4.2 Certificate Generation System
Automated and manual certificate generation with PDF templates, QR verification, and student gallery.

**Deliverables:**
- Certificate model with polymorphic relationships
- Certificate templates (Arabic + English)
- PDF generation service
- Auto-generation for course completion
- Manual issuance by teachers
- QR code verification system
- Student certificate gallery
- Certificate sharing functionality

### 4.3 Trial Session System Completion
Complete trial session workflow with login requirement, approval, scheduling, and expiration.

**Deliverables:**
- Login requirement for trial requests
- Teacher/admin approval interface (Filament)
- Trial scheduling workflow
- Student notifications (approval, scheduling)
- Trial expiration logic (7 days)
- Trial session badge/indicator in UI
- Trial analytics for teachers

### 4.4 Advanced Analytics Dashboard
Create academy-wide analytics with teacher performance, student engagement, and revenue metrics.

**Deliverables:**
- Academy analytics dashboard
- Teacher performance metrics
- Student engagement analytics
- Revenue/payment analytics
- Session completion rates
- Attendance trends visualization
- Exportable reports
- Real-time metrics

## Technical Requirements
- Laravel 11.x
- Filament 3.x for admin panels
- LiveKit for video conferencing
- Livewire for real-time UI components
- MySQL database with proper indexing
- Queue-based processing for heavy operations
- Redis caching for performance
- Multi-tenant architecture support

## Success Metrics
- Zero breaking changes to existing features
- LiveKit rooms functional for all session types
- Real-time attendance tracking <500ms latency
- Interactive course enrollment conversion >70%
- Homework submission rate >80%
- Parent dashboard adoption >60%
- Quiz completion rate >75%
- Certificate generation <30 seconds
